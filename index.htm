<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Carta ðŸŒ¹ðŸš²</title>

  <style>
    :root{
      --bg1:#120016;
      --bg2:#2b001f;
      --accent:#ff4d88;
      --rose:#ff2d55;
      --rose2:#ff7aa2;
      --paper:#fff6fb;
      --ink:#2a0b1a;
      --gold:#f7c76a;
      --white: rgba(255,255,255,.92);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:white;
      overflow-x:hidden;
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(255,77,136,.18), transparent 60%),
        radial-gradient(900px 700px at 80% 30%, rgba(247,199,106,.12), transparent 55%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
    }

    /* PÃ©talos */
    .petals{ position:fixed; inset:0; pointer-events:none; overflow:hidden; z-index:1; }
    .petal{
      position:absolute;
      width:14px; height:18px;
      background: linear-gradient(180deg, var(--rose2), var(--rose));
      border-radius: 70% 30% 70% 30% / 60% 40% 60% 40%;
      opacity:.85;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.25));
      animation: fall linear forwards;
    }
    @keyframes fall{
      0%{ transform: translateY(-30px) rotate(0deg); opacity:0; }
      10%{ opacity:.9; }
      100%{ transform: translateY(110vh) rotate(360deg); opacity:.2; }
    }

    .wrap{
      position:relative;
      z-index:2;
      max-width: 980px;
      margin: 0 auto;
      padding: 32px 18px 56px;
      display:grid;
      gap:18px;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 14px 16px;
      border-radius:18px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
    }
    .brand{ display:flex; align-items:center; gap:10px; user-select:none; }
    .logo{
      width:42px;height:42px; border-radius:14px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.25), transparent 60%),
        linear-gradient(135deg, rgba(255,77,136,.9), rgba(247,199,106,.75));
      display:grid; place-items:center;
      box-shadow: 0 12px 26px rgba(0,0,0,.28);
    }
    .logo span{ font-size:20px; filter: drop-shadow(0 4px 10px rgba(0,0,0,.25)); }
    .brand h1{ margin:0; font-size: 16px; letter-spacing:.3px; font-weight: 800; }
    .brand p{ margin:0; font-size: 12px; opacity:.8; }

    .btns{ display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; }
    button{
      appearance:none; border:0; border-radius:14px;
      padding:10px 12px; font-weight:800; cursor:pointer;
      color:#16000f;
      background: linear-gradient(135deg, rgba(255,77,136,1), rgba(247,199,106,1));
      box-shadow: 0 12px 24px rgba(0,0,0,.25);
      transition: transform .15s ease, filter .15s ease, opacity .15s ease;
    }
    button:hover{ transform: translateY(-1px); filter: brightness(1.05); }
    button:active{ transform: translateY(0px) scale(.99); }
    button:disabled{ opacity:.6; cursor:not-allowed; }
    .ghost{
      background: rgba(255,255,255,.08);
      color: white;
      border: 1px solid rgba(255,255,255,.12);
      box-shadow:none;
    }

    main{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
      align-items:start;
    }
    @media (max-width: 860px){ main{ grid-template-columns: 1fr; } }

    .card{
      border-radius:22px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(12px);
      overflow:hidden;
      box-shadow: 0 18px 44px rgba(0,0,0,.25);
    }
    .cardTop{
      padding:18px 18px 0;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      font-size: 12px; opacity:.95; user-select:none;
    }
    .badge i{
      width:10px;height:10px;border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff, var(--accent));
      box-shadow: 0 0 18px rgba(255,77,136,.55);
    }

    .paper{
      margin: 14px 18px 18px;
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,246,251,.98), rgba(255,246,251,.92));
      color: var(--ink);
      padding: 18px 18px 16px;
      position:relative;
      overflow:hidden;
      min-height: 320px;
    }
    .paper:before{
      content:"";
      position:absolute; inset:-60px;
      background:
        radial-gradient(circle at 15% 20%, rgba(255,77,136,.10), transparent 55%),
        radial-gradient(circle at 85% 25%, rgba(247,199,106,.12), transparent 60%),
        radial-gradient(circle at 40% 80%, rgba(255,45,85,.08), transparent 55%);
      pointer-events:none;
      transform: rotate(-6deg);
    }

    .letter{ position:relative; display:grid; gap:12px; }
    .letter h2{ margin:0; font-size: 22px; line-height:1.2; }
    .letter p{ margin:0; font-size: 15px; line-height: 1.55; min-height: 140px; }

    .signature{
      margin-top: 6px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      font-size: 13px; opacity:.9;
    }
    .sign{ font-weight: 900; letter-spacing:.4px; }

    .roses{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 6px; }
    .rose{
      width:34px;height:34px; border-radius:14px;
      background:
        radial-gradient(circle at 30% 35%, rgba(255,255,255,.5), transparent 45%),
        radial-gradient(circle at 65% 70%, rgba(255,255,255,.25), transparent 55%),
        linear-gradient(135deg, rgba(255,77,136,1), rgba(255,45,85,1));
      box-shadow: 0 10px 18px rgba(255,77,136,.18);
      position:relative;
      transform: rotate(-8deg);
    }
    .rose:after{
      content:""; position:absolute; inset:8px;
      border-radius: 12px;
      border: 1px dashed rgba(255,255,255,.55);
      opacity:.6;
    }

    /* Panel bici */
    .side{ display:grid; gap:18px; }
    .bikeCard{ padding:18px; position:relative; }
    .bikeTitle{ margin:0 0 10px; font-size: 16px; font-weight:900; }
    .bikeHint{ margin:0 0 14px; opacity:.85; font-size: 13px; line-height:1.4; }

    .road{
      height:190px;
      border-radius:18px;
      background:
        linear-gradient(180deg, rgba(255,255,255,.10), rgba(0,0,0,.10)),
        radial-gradient(500px 220px at 40% 0%, rgba(255,77,136,.20), transparent 70%);
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      position:relative;
    }
    .horizon{
      position:absolute; left:0; right:0; top:54px;
      height:2px; background: rgba(255,255,255,.10);
    }
    .dashes{
      position:absolute; left:-30%; right:-30%; bottom:22px;
      height:4px;
      background: repeating-linear-gradient(90deg, rgba(247,199,106,.9) 0 18px, transparent 18px 42px);
      opacity:.9;
      animation: moveRoad 1.1s linear infinite;
    }
    @keyframes moveRoad{ to{ transform: translateX(-42px); } }

    /* ðŸš² Bici (SVG) */
    .bike{
      position:absolute;
      left:-260px;
      bottom:44px;
      width:260px;
      height:120px;
      animation: ride 9s linear infinite;
      filter: drop-shadow(0 14px 22px rgba(0,0,0,.28));
    }
    @keyframes ride{
      0%{ transform: translateX(-280px); }
      100%{ transform: translateX(calc(100% + 320px)); }
    }

    .heartPin{
      position:absolute;
      left: 120px;
      top: -18px;
      font-size: 16px;
      opacity:.95;
      animation: float 1.6s ease-in-out infinite;
      text-shadow: 0 10px 18px rgba(0,0,0,.25);
    }
    @keyframes float{
      0%,100%{ transform: translateY(0); }
      50%{ transform: translateY(-6px); }
    }

    .bikeSvg{ width:100%; height:100%; overflow:visible; }
    .bikeSvg .rim{ fill: rgba(255,255,255,.06); stroke: rgba(255,255,255,.90); stroke-width: 6; }
    .bikeSvg .hub{ fill: rgba(255,255,255,.85); }
    .bikeSvg .spokes line{ stroke: rgba(255,255,255,.26); stroke-width: 2.2; stroke-linecap: round; }
    .bikeSvg .tube{ stroke: rgba(255,77,136,.95); stroke-width: 7; stroke-linecap: round; stroke-linejoin: round; }
    .bikeSvg .tube.soft{ stroke: rgba(247,199,106,.65); stroke-width: 6; }
    .bikeSvg .bar{ stroke: rgba(255,255,255,.85); stroke-width: 7; stroke-linecap: round; }
    .bikeSvg .seat{ fill: rgba(255,255,255,.88); }
    .bikeSvg .ring{ fill: rgba(0,0,0,.10); stroke: rgba(255,255,255,.75); stroke-width: 3; }
    .bikeSvg .crank{ stroke: rgba(255,255,255,.75); stroke-width: 4; stroke-linecap: round; }
    .bikeSvg .pedal{ fill: rgba(255,255,255,.90); }
    .bikeSvg .chain{ fill:none; stroke: rgba(255,255,255,.28); stroke-width: 3; stroke-dasharray: 6 7; stroke-linecap: round; }
    .bikeSvg .wheel{ transform-box: fill-box; transform-origin: center; animation: spinWheel .8s linear infinite; }
    @keyframes spinWheel{ to{ transform: rotate(360deg); } }

    /* Modal */
    .overlay{
      position:fixed; inset:0;
      background: rgba(0,0,0,.55);
      display:none; align-items:center; justify-content:center;
      padding:18px; z-index:10;
      backdrop-filter: blur(6px);
    }
    .overlay.show{ display:flex; }
    .modal{
      max-width: 760px; width:100%;
      border-radius: 22px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 22px 60px rgba(0,0,0,.35);
      overflow:hidden;
    }
    .modalHeader{
      padding: 14px 16px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      background: rgba(0,0,0,.20);
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .modalHeader h3{ margin:0; font-size: 14px; font-weight: 900; letter-spacing:.3px; }
    .close{ border-radius: 12px; padding: 8px 10px; }
    .modalBody{ padding: 16px; }
    label{ display:block; font-size: 12px; opacity:.85; margin: 10px 0 6px; }
    input, textarea{
      width:100%;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color:white;
      padding: 10px 12px;
      outline:none;
      font-size: 14px;
    }
    textarea{ min-height: 140px; resize: vertical; }
    .modalActions{ display:flex; gap:10px; flex-wrap:wrap; padding: 0 16px 16px; }

    /* Corazones */
    .heart{
      position:fixed; font-size: 16px; pointer-events:none; z-index: 20;
      animation: pop 900ms ease-out forwards;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.25));
    }
    @keyframes pop{
      0%{ transform: translate(-50%,-50%) scale(.8); opacity:0; }
      10%{ opacity:1; }
      100%{ transform: translate(-50%,-120%) scale(1.35); opacity:0; }
    }

    footer{ opacity:.8; font-size: 12px; text-align:center; padding: 6px 4px; }
    .tiny{ opacity:.8; font-size:12px; }
  </style>
</head>

<body>
  <div class="petals" id="petals"></div>

  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo"><span>ðŸŒ¹</span></div>
        <div>
          <h1>Para mi Pioquinto linda ðŸ¦†</h1>
          <p>la reina mas hermosa de este mundo mundial</p>
        </div>
      </div>
      <div class="btns">
        <button class="ghost" id="btnHearts" type="button">Lluvia de amor ðŸ’—</button>
        <!-- âœ… Cambiado: ya no dice editar -->
        <button id="btnOpen" type="button">Enviar respuesta ðŸ’Œ</button>
      </div>
    </header>

    <main>
      <section class="card">
        <div class="cardTop">
          <span class="badge"><i></i></span>
          <span class="tiny" id="dateText"></span>
        </div>

        <div class="paper">
          <div class="letter">
            <h2 id="toText">ðŸ¦†ðŸ‘‘</h2>
            <p id="bodyText">
Lo nuestro no empieza de cero, empieza con memoria.
Con la historia de dos personas que se amaron, se perdieron y tuvieron el valor de volver a mirarse.

Fuiste mi novia, y no lo digo desde la nostalgia, sino desde el reconocimiento de lo que compartimos y de lo que aprendimos al separarnos.
El tiempo nos cambiÃ³, nos hizo mÃ¡s conscientes, mÃ¡s honestos con lo que queremos y con lo que ya no.

Este no es un intento por revivir lo que fue, sino la decisiÃ³n de comenzar algo nuevo contigo.
Un amor mÃ¡s tranquilo, mÃ¡s elegido, mÃ¡s cuidado.

Hoy no volvemos porque no supimos soltar, sino porque sabemos exactamente lo que significamos el uno para el otro.
Volvemos sin exigirnos ser quienes Ã©ramos, pero con el compromiso de ser mejores de lo que fuimos.

Que este nuevo inicio no sea una promesa vacÃ­a, sino un acuerdo sincero:
caminar juntos, escucharnos sin huir, y cuidarnos incluso cuando amar cueste.

Porque esta vez, no es el pasado el que nos une,
es la decisiÃ³n consciente de volver a elegirnos.
            </p>

            <div class="roses" aria-hidden="true">
              <div class="rose"></div><div class="rose"></div><div class="rose"></div>
              <div class="rose"></div><div class="rose"></div><div class="rose"></div>
            </div>

            <div class="signature">
              <span id="fromText" class="sign"></span>
              <span class="tiny"></span>
            </div>
          </div>
        </div>
      </section>

      <aside class="side">
        <section class="card bikeCard">
          <h3 class="bikeTitle"></h3>
          <p class="bikeHint"></p>

          <div class="road">
            <div class="horizon"></div>
            <div class="dashes"></div>

            <div class="bike" aria-hidden="true">
              <div class="heartPin">ðŸ’—</div>

              <svg class="bikeSvg" viewBox="0 0 520 220" xmlns="http://www.w3.org/2000/svg">
                <g class="wheel wL">
                  <circle cx="140" cy="160" r="56" class="rim"/>
                  <circle cx="140" cy="160" r="6" class="hub"/>
                  <g class="spokes">
                    <line x1="140" y1="160" x2="140" y2="104"/>
                    <line x1="140" y1="160" x2="140" y2="216"/>
                    <line x1="140" y1="160" x2="84"  y2="160"/>
                    <line x1="140" y1="160" x2="196" y2="160"/>
                    <line x1="140" y1="160" x2="100" y2="120"/>
                    <line x1="140" y1="160" x2="180" y2="200"/>
                    <line x1="140" y1="160" x2="180" y2="120"/>
                    <line x1="140" y1="160" x2="100" y2="200"/>
                  </g>
                </g>

                <g class="wheel wR">
                  <circle cx="380" cy="160" r="56" class="rim"/>
                  <circle cx="380" cy="160" r="6" class="hub"/>
                  <g class="spokes">
                    <line x1="380" y1="160" x2="380" y2="104"/>
                    <line x1="380" y1="160" x2="380" y2="216"/>
                    <line x1="380" y1="160" x2="324" y2="160"/>
                    <line x1="380" y1="160" x2="436" y2="160"/>
                    <line x1="380" y1="160" x2="340" y2="120"/>
                    <line x1="380" y1="160" x2="420" y2="200"/>
                    <line x1="380" y1="160" x2="420" y2="120"/>
                    <line x1="380" y1="160" x2="340" y2="200"/>
                  </g>
                </g>

                <g class="frame">
                  <line x1="190" y1="90"  x2="250" y2="160" class="tube"/>
                  <line x1="250" y1="160" x2="320" y2="95"  class="tube"/>
                  <line x1="320" y1="95"  x2="190" y2="90"  class="tube"/>

                  <line x1="250" y1="160" x2="380" y2="160" class="tube"/>
                  <line x1="320" y1="95"  x2="380" y2="160" class="tube"/>

                  <line x1="190" y1="90"  x2="140" y2="160" class="tube"/>
                  <line x1="250" y1="160" x2="140" y2="160" class="tube soft"/>

                  <line x1="320" y1="95"  x2="305" y2="60"  class="tube"/>
                  <line x1="285" y1="58"  x2="330" y2="58"  class="bar"/>

                  <line x1="190" y1="90"  x2="175" y2="55"  class="tube"/>
                  <rect x="155" y="48" width="48" height="14" rx="8" class="seat"/>
                </g>

                <g class="drivetrain">
                  <circle cx="250" cy="160" r="18" class="ring"/>
                  <circle cx="250" cy="160" r="4"  class="hub"/>
                  <line x1="250" y1="160" x2="280" y2="175" class="crank"/>
                  <rect x="278" y="172" width="22" height="10" rx="6" class="pedal"/>
                  <path d="M250 160 C 295 162, 330 168, 380 160" class="chain"/>
                </g>
              </svg>
            </div>
          </div>
          <!-- Spotify (Bad Bunny - BAILE INoLVIDABLE) -->
<div style="margin-top:14px;">
  <iframe
    style="border-radius:16px"
    src="https://open.spotify.com/embed/track/2lTm559tuIvatlT1u0JYG2?utm_source=generator"
    width="100%"
    height="152"
    frameborder="0"
    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
    loading="lazy">
  </iframe>
</div>

        </section>
      </aside>
    </main>

    <footer></footer>
  </div>

  <!-- Modal: Responder -->
  <div class="overlay" id="overlay" role="dialog" aria-modal="true">
    <div class="modal">
      <div class="modalHeader">
        <h3>Escribe tu respuesta</h3>
        <button class="ghost close" id="btnClose" type="button">Cerrar</button>
      </div>

      <div class="modalBody">
        <label>Para</label>
        <input id="inTo" placeholder="Tu nombre" />

        <label>Tu mensaje</label>
        <textarea id="inBody" placeholder="Escribe aquÃ­ lo que sientesâ€¦"></textarea>

        <label>Tu nombre</label>
        <input id="inFrom" placeholder="Firma (opcional)" />
      </div>

      <div class="modalActions">
        <button id="btnSend" type="button">Enviar respuesta ðŸ’Œ</button>
        <!-- âœ… Limpiar ahora limpia SOLO el formulario -->
        <button class="ghost" id="btnReset" type="button">Limpiar</button>
      </div>
    </div>
  </div>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

  <script>
    /* ========= CONFIG EMAILJS (tus datos) ========= */
    const PUBLIC_KEY  = "U5iEtegZ7u9daw3K5";
    const SERVICE_ID  = "service_5r1ywta";
    const TEMPLATE_ID = "template_jvl0fs9";

    (function(){ emailjs.init(PUBLIC_KEY); })();

    /* ========= Fecha ========= */
    const dateText = document.getElementById('dateText');
    const now = new Date();
    dateText.textContent = now.toLocaleDateString('es-MX', {
      weekday:'long', year:'numeric', month:'long', day:'numeric'
    });

    /* ========= Modal ========= */
    const overlay  = document.getElementById('overlay');
    const btnOpen  = document.getElementById('btnOpen');
    const btnClose = document.getElementById('btnClose');
    const btnReset = document.getElementById('btnReset');
    const btnSend  = document.getElementById('btnSend');

    const inTo   = document.getElementById('inTo');
    const inBody = document.getElementById('inBody');
    const inFrom = document.getElementById('inFrom');

    function openModal(){
      overlay.classList.add('show');
      setTimeout(()=> inBody.focus(), 40);
    }
    function closeModal(){ overlay.classList.remove('show'); }

    btnOpen.addEventListener('click', openModal);
    btnClose.addEventListener('click', closeModal);
    overlay.addEventListener('click', (e)=>{ if(e.target === overlay) closeModal(); });

    // âœ… Limpiar: limpia SOLO lo que ella escribiÃ³ en el modal
    btnReset.addEventListener('click', ()=>{
      inTo.value = "";
      inBody.value = "";
      inFrom.value = "";
      inBody.focus();
    });

    /* ========= Corazones ========= */
    function heartAt(x,y){
      const h = document.createElement('div');
      h.className = 'heart';
      h.textContent = Math.random() > 0.5 ? 'ðŸ’—' : 'ðŸ’–';
      h.style.left = x + 'px';
      h.style.top = y + 'px';
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), 900);
    }
    function burstHearts(n=12){
      const cx = window.innerWidth/2;
      const cy = 120;
      for(let i=0;i<n;i++){
        setTimeout(()=> heartAt(cx + (Math.random()*180-90), cy + (Math.random()*120-60)), i*28);
      }
    }
    document.getElementById('btnHearts').addEventListener('click', ()=> burstHearts(26));

    /* ========= PÃ©talos ========= */
    const petals = document.getElementById('petals');
    function spawnPetal(){
      const p = document.createElement('div');
      p.className = 'petal';
      const startX = Math.random() * window.innerWidth;
      const duration = 6000 + Math.random()*7000;
      const delay = Math.random()*800;
      const size = 10 + Math.random()*10;

      p.style.left = startX + 'px';
      p.style.width = size + 'px';
      p.style.height = (size*1.2) + 'px';
      p.style.animationDuration = duration + 'ms';
      p.style.animationDelay = delay + 'ms';

      petals.appendChild(p);
      setTimeout(()=> p.remove(), duration + delay + 200);
    }
    setInterval(()=> {
      if (document.hidden) return;
      spawnPetal();
      if (Math.random() < 0.35) spawnPetal();
    }, 420);

    /* ========= Enviar (sin error al reenviar) =========
       - Deshabilita el botÃ³n mientras envÃ­a
       - Cambia el texto a "Enviandoâ€¦"
       - Mensaje de error mÃ¡s claro (ya no â€œHubo un error al enviarâ€ genÃ©rico)
    */
    let sending = false;

    btnSend.addEventListener("click", async () => {
      if (sending) return; // evita doble clic

      const to = inTo.value.trim();
      const message = inBody.value.trim();
      const from = inFrom.value.trim();

      if (!message) {
        alert("Escribe tu mensaje antes de enviar ðŸ’—");
        return;
      }

      sending = true;
      const originalText = btnSend.textContent;
      btnSend.disabled = true;
      btnSend.textContent = "Enviandoâ€¦";

      try {
        await emailjs.send(
          SERVICE_ID,
          TEMPLATE_ID,
          {
            to_name: to || "Carta privada",
            message: message,
            from_name: from || "Respuesta anÃ³nima ðŸ’Œ"
          }
        );

        alert("ðŸ’Œ Listo: tu respuesta ya fue enviada");
        burstHearts(18);
        btnReset.click();
        closeModal();
      } catch (err) {
        console.error("EmailJS error:", err);

        // âœ… Mensaje de error mÃ¡s Ãºtil (y bonito)
        const detail =
          (err && (err.text || err.message)) ? (err.text || err.message) :
          "Revisa tu Template/Service o intenta de nuevo en unos segundos.";

        alert("No se pudo enviar por el momento ðŸ˜¢\n\nDetalle: " + detail);
      } finally {
        sending = false;
        btnSend.disabled = false;
        btnSend.textContent = originalText;
      }
    });

    // Arranque
    setTimeout(()=> burstHearts(10), 700);
  </script>
</body>
</html>
